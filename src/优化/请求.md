## 优化的本质是提示资源利用率，所做的一切都是围绕这一点

首先要知道前端慢，慢在哪？
表现是打开/加载一个页面慢
### 内部
排除和外部交互因素下，前端内部为什么慢
1.页面元素过多，浏览器解析起来慢
### 外部
和外部交互导致的慢
1.http请求多
2.http请求耗时高（排队：浏览器排队、服务器响应排队）

假设有100个请求，每个请求平均耗时500ms，同时最多3个请求，那总耗时：（100/3）*500ms
=========
=======
======
	  =======
	   ========
	     ==
		   ======
		     ======
为什么请求多会慢？
1.简单的数学计算就能知道
2.请求多，会导致服务端压力大，如果服务端没有做好过载保护，会导致qps下降

为什么请求耗时会高？
1.服务端负载高，请求耗时自然高
2.网络IO导致的耗时高。（网络传输耗时=大小*距离/速度）请求大/跨地区/网卡高负载/网络有问题等等


如何优化？

1. 核心是减小服务端负载或让服务端（可能涉及多类服务）负载更均衡
2. 减少网络传输（减少请求量、减少请求大小）
3. 减小传输距离
4. 增加并行度（充分利用资源）

具体怎么做？
1. 增加客户端并行度
2. 服务端水平拆分（比如拆分为图片服务器和业务逻辑服务？）
3. 客户端本地缓存（减小请求量）
4. 服务端缓存（客户端缓存有限，服务端理论上可以做全量缓存，加快响应速度）
5. 请求压缩（使用压缩算法减小请求大小）
6. cdn（减小传输距离）
7. 懒加载（减小请求量）

减少请求量：
1、缓存
2、懒加载
3、合并资源：图片（雪碧图、base64）、css、js
减少请求大小：
1、压缩:体积压缩、传输压缩
减少请求距离：
1、cdn
提升并行度：
1、协议升级



## 请求
- 请求个数限制
	- chrome 6个，一旦6个连接使用完，必须排队等待
- HTTP 的request/response 流程
- 怎么优化请求
	- 减少请求个数(合并请求)
		- 图片 <br>
			1、 CSS 雪碧图（构建工具）<br>
			2、 base64 inline <br>
			
				- 原理：
				- 适用场景： 图片很少被更新、图片尺寸较小
				- 优点：
					减少HTTP请求
					某些文件可以避免跨域问题
					没有【图片更新要重新上传还要清理缓存的问题】
				- 缺点：
					ie6/ie7不支持
					大小比原文件大  
					无法缓存，要缓存只能缓存包含base64的文件.比如html/css，但是这两类文件一般改动比较频繁 <br>
			3、SVG
			
				- 矢量：放大不失真（矢量图标iconfont字体颜色一个图标只支持1种颜色，制作成本更大）
				- 支持多色 （换肤）
				- 支持动画
		- 合并js/css 资源
	- 协议升级（http2）
	
## 流量
### 缓存
	- 浏览器缓存
	- 服务器缓存
	- HTML5缓存
### 无缓存的情况下，优化资源文件
 - 体积压缩
 	- 静态资源压缩
 	
			- CSS
			- JS
			- IMG	
			 	- SVG: svgOmg
			 	- PNG: tinypng
			 	- JPEG: photoshop
			 	- apng取代gif 	
 - 传输压缩
 	- 服务器开启Gzip 
 - 图片服务器动态响应
 	- 独立域名部署图片资源，分担web服务器端I/O负载，能够专门针对图片服务器进行优化
 - 页面切片预加载  
 - 懒加载	·去·
 
## 渲染
### 判断渲染性能的指标：FPS
- FPS是什么： 每秒渲染的次数、 刷新频率
- 哪些行为对FPS有影响
	- 动画
	- 页面交互的响应
- 每一帧都尽量在16毫秒以内
- 浏览器绘制页面的过程 
	- JS/CSS：影响样式计算 JS动画部分
	- layout:宽高、间距、位置变化，会级联影响其他元素的布局计算
	- paint：阴影
	- composite: 多个图层合并形成页面，opacity、transform会影响
	- reflow里面有大量的layout

	fps：不是越高越好，60左右
- 优化方法：
	- 利用浏览器的惰性布局：读写分离、批量操作
	- 将调用权交还给浏览器将读写操作都放入RAF函数中
	- classList替代className
		- className只要赋值，就一定会出现一次render计算
		- classList的add和remove，浏览器会进行样式是否已存在的判断，减少重复的render
	- transform代替【布局属性实现元素的变化】
	- GPU加速： 
		- 要记得释放







 
	
				 
	